<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>Happy Birthday ğŸ’›</title>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<style>
:root{
  --bg: linear-gradient(to top, #ffcc33, #fff6cc);
  --card: rgba(255,255,255,0.88);
  --accent: #f4b400;
  --text:#3b2f00;
}

*{ -webkit-tap-highlight-color: transparent; }

body{
  margin:0;
  font-family:Poppins,system-ui;
  background:var(--bg);
  color:var(--text);
  overflow:hidden;
}

/* ğŸŒ… SUNRISE */
.sunrise{
  position:fixed;
  bottom:-160px;
  left:50%;
  transform:translateX(-50%);
  width:300px;
  height:300px;
  background:radial-gradient(circle,#fff6a3,#ffb300);
  border-radius:50%;
  filter:blur(2px);
  animation:sunrise 8s ease-in-out forwards;
  z-index:-1;
}
@keyframes sunrise{
  to{ bottom:40%; }
}

/* ---------- SCREENS ---------- */
.screen{
  position:absolute;
  inset:0;
  display:none;
  align-items:center;
  justify-content:center;
  flex-direction:column;
  padding:20px;
}
.screen.active{display:flex}

.card{
  background:var(--card);
  padding:clamp(22px,5vw,32px);
  border-radius:28px;
  max-width:460px;
  width:100%;
  text-align:center;
  box-shadow:0 25px 60px rgba(0,0,0,.18);
  animation:fadeUp .7s ease;
}

@keyframes fadeUp{
  from{opacity:0;transform:translateY(24px)}
  to{opacity:1}
}

h2,h3{
  font-size:clamp(22px,5vw,28px);
  color:#d18b00;
}

p{
  font-size:clamp(14px,4vw,16px);
  line-height:1.7;
}

/* ---------- BUTTONS ---------- */
button{
  padding:14px 30px;
  border:none;
  border-radius:40px;
  background:linear-gradient(135deg,#ffd84d,#f4b400);
  color:#3b2f00;
  font-size:16px;
  cursor:pointer;
  margin-top:18px;
  box-shadow:0 10px 25px rgba(244,180,0,.4);
}
button:active{transform:scale(.96)}

.back{ background:#fff3c4; }

/* ---------- COUNTRY ---------- */
.country{
  margin:12px 0;
  padding:15px 20px;
  border-radius:30px;
  background:#fff1b8;
  cursor:pointer;
  font-weight:500;
  transition:.25s;
}
.country:hover{
  background:var(--accent);
  color:#fff;
}

/* ---------- PLANE ---------- */
.plane{
  position:absolute;
  font-size:60px;
  left:-80px;
  top:42%;
  animation:fly 3s ease-out forwards;
}
@keyframes fly{
  70%{transform:translateX(80vw) translateY(-18px)}
  100%{transform:translateX(95vw) translateY(10px)}
}

.smoke{
  position:absolute;
  bottom:38%;
  font-size:26px;
  opacity:0;
  animation:smoke 1.4s ease forwards;
}
@keyframes smoke{
  to{opacity:0;transform:translateY(-40px) scale(1.5)}
}

/* ---------- CANDLE ---------- */
.candle{
  width:90px;height:150px;
  background:linear-gradient(#ffe680,#ffc933);
  border-radius:18px;
  position:relative;
  margin:22px auto;
}
.flame{
  width:22px;height:34px;
  background:radial-gradient(circle,#fff,#ff9800);
  border-radius:50%;
  position:absolute;
  top:-34px;
  left:34px;
  animation:flicker .15s infinite;
}
@keyframes flicker{50%{transform:scale(.85)}}
.hidden{display:none}

/* ---------- SUNFLOWERS ---------- */
.petal{
  position:fixed;
  top:-40px;
  font-size:26px;
  animation:fall linear forwards;
  pointer-events:none;
}
@keyframes fall{
  to{transform:translateY(110vh) rotate(360deg)}
}
</style>
</head>

<body>

<div class="sunrise"></div>

<audio id="bgMusic" loop muted>
  <source src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_5b7a68a4ad.mp3" type="audio/mpeg">
</audio>

<div class="screen active">
  <div class="card">
    <h2>Welcome ğŸŒ»</h2>
    <p>A warm sunrise, just for you</p>
    <button onclick="start()">Begin</button>
  </div>
</div>

<div class="screen" id="s2">
  <div class="card">
    <h3>Choose a country ğŸŒ</h3>
    <div class="country" onclick="travel('india')">ğŸ‡®ğŸ‡³ India</div>
    <div class="country" onclick="travel('saudi')">ğŸ‡¸ğŸ‡¦ Saudi Arabia</div>
    <div class="country" onclick="travel('japan')">ğŸ‡¯ğŸ‡µ Japan</div>
    <div class="country" onclick="travel('korea')">ğŸ‡°ğŸ‡· South Korea</div>
  </div>
</div>

<div class="screen" id="s3">
  <div class="plane">âœˆï¸</div>
  <div class="smoke">â˜ï¸ â˜ï¸ â˜ï¸</div>
  <p>Landing softlyâ€¦ ğŸ›¬</p>
</div>

<div class="screen" id="s4">
  <div class="card">
    <div class="candle">
      <div class="flame" id="flame"></div>
    </div>
    <p>Blow to make a wish ğŸŒ</p>
    <button onclick="blow()">Tap Instead</button>
  </div>
</div>

<div class="screen" id="s5">
  <div class="card">
    <h2>ğŸ‰ Happy Birthday ğŸ‰</h2>
    <p id="note"></p>
    <p style="font-size:22px">ğŸŒ»ğŸ«âœ¨ğŸˆğŸ’›</p>
    <button class="back" onclick="back()">â¬… Back</button>
  </div>
</div>

<script>
let petalInterval;
let audioContext, analyser, micStream;
let blowing=false;
const music=document.getElementById("bgMusic");

function start(){
  music.muted=false;
  music.play();
  go(2);
}

function go(n){
  stopPetals();
  document.querySelectorAll(".screen").forEach(s=>s.classList.remove("active"));
  document.getElementById("s"+n)?.classList.add("active");
  if(n===4) startMic(); else stopMic();
}

const notes={
  india:`<b>Nimra</b> ğŸ’›<br><br>Janmadin Mubarak ğŸŒ»<br>Wishing you a day full of small joys and peaceful moments ğŸ’•`,
  saudi:`<b>Nimra</b> ğŸ’›<br><br>Ø¹ÙŠØ¯ Ù…ÙŠÙ„Ø§Ø¯ Ø³Ø¹ÙŠØ¯ ğŸŒ»<br>Wishing you a year filled with quiet smiles and warm moments ğŸŒ¸`,
  japan:`<b>Nimra</b> ğŸ’›<br><br>ãŠèª•ç”Ÿæ—¥ãŠã‚ã§ã¨ã† ğŸŒ»<br>Wishing you a gentle year ahead, one smile at a time ğŸŒ¿`,
  korea:`<b>Nimra</b> ğŸ’›<br><br>ìƒì¼ ì¶•í•˜í•´ìš” ğŸŒ»<br>Wishing you a birthday full of soft smiles and happy thoughts ğŸŒ»`
};

let selectedNote="";

function travel(c){
  selectedNote=notes[c];
  go(3);
  setTimeout(()=>go(4),3000);
}

function blow(){
  if(blowing) return;
  blowing=true;
  document.getElementById("flame").classList.add("hidden");
  confetti({particleCount:160,spread:120});
  document.getElementById("note").innerHTML=selectedNote;
  go(5);
  startPetals();
}

function back(){
  blowing=false;
  document.getElementById("flame").classList.remove("hidden");
  go(2);
}

function startPetals(){
  petalInterval=setInterval(()=>{
    let p=document.createElement("div");
    p.className="petal";
    p.innerHTML="ğŸŒ»";
    p.style.left=Math.random()*100+"vw";
    p.style.animationDuration=6+Math.random()*4+"s";
    document.body.appendChild(p);
    setTimeout(()=>p.remove(),10000);
  },450);
}
function stopPetals(){clearInterval(petalInterval);}

/* ğŸ¤ Blow Detection */
async function startMic(){
  try{
    audioContext = new (window.AudioContext || window.webkitAudioContext)();
    micStream = await navigator.mediaDevices.getUserMedia({audio:true});
    const source = audioContext.createMediaStreamSource(micStream);
    analyser = audioContext.createAnalyser();
    source.connect(analyser);
    detectBlow();
  }catch(e){}
}

function detectBlow(){
  const data = new Uint8Array(analyser.frequencyBinCount);
  function check(){
    analyser.getByteFrequencyData(data);
    let volume = data.reduce((a,b)=>a+b)/data.length;
    if(volume>60) blow();
    if(!blowing) requestAnimationFrame(check);
  }
  check();
}

function stopMic(){
  if(micStream){
    micStream.getTracks().forEach(track=>track.stop());
  }
}
</script>

</body>
</html>

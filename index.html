<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>Happy Birthday ğŸ’›</title>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<style>
:root{
  --bg: linear-gradient(to top, #ffcc33, #fff6cc);
  --card: rgba(255,255,255,0.9);
}

body{
  margin:0;
  font-family:Poppins,system-ui;
  background:var(--bg);
  overflow:hidden;
  color:#3b2f00;
}

/* SUNRISE */
.sunrise{
  position:fixed;
  bottom:-160px;
  left:50%;
  transform:translateX(-50%);
  width:320px;
  height:320px;
  background:radial-gradient(circle,#fff6a3,#ffb300);
  border-radius:50%;
  animation:sunrise 8s ease forwards;
  z-index:-1;
}
@keyframes sunrise{to{bottom:40%;}}

/* SCREENS */
.screen{
  position:absolute;
  inset:0;
  display:none;
  align-items:center;
  justify-content:center;
  flex-direction:column;
  padding:20px;
}
.screen.active{display:flex}

.card{
  background:var(--card);
  padding:28px;
  border-radius:30px;
  max-width:460px;
  width:100%;
  text-align:center;
  box-shadow:0 25px 60px rgba(0,0,0,.18);
}

button{
  padding:14px 30px;
  border:none;
  border-radius:40px;
  background:linear-gradient(135deg,#ffd84d,#f4b400);
  font-size:16px;
  cursor:pointer;
  margin-top:18px;
}

/* COUNTRY */
.country{
  margin:12px 0;
  padding:15px;
  border-radius:30px;
  background:#fff1b8;
  cursor:pointer;
}

/* PLANE */
.plane{
  position:absolute;
  font-size:60px;
  left:-80px;
  top:42%;
  animation:fly 3s ease-out forwards;
}
@keyframes fly{
  70%{transform:translateX(80vw) translateY(-18px)}
  100%{transform:translateX(95vw) translateY(10px)}
}

.cloudPuff{
  position:absolute;
  font-size:40px;
  bottom:38%;
  opacity:0;
  animation:puff 1.2s ease forwards;
}
@keyframes puff{
  to{opacity:1;transform:scale(1.8);opacity:0;}
}

/* CANDLE */
.candle{
  width:90px;height:150px;
  background:linear-gradient(#ffe680,#ffc933);
  border-radius:18px;
  position:relative;
  margin:22px auto;
}
.flame{
  width:22px;height:34px;
  background:radial-gradient(circle,#fff,#ff9800);
  border-radius:50%;
  position:absolute;
  top:-34px;
  left:34px;
  transition:.1s;
}
.hidden{display:none}

/* GOLD GLOW NAME */
.glow{
  font-size:20px;
  font-weight:bold;
  background:linear-gradient(45deg,#ffd84d,#ffb300,#fff6a3);
  -webkit-background-clip:text;
  color:transparent;
  animation:shine 3s linear infinite;
}
@keyframes shine{
  from{background-position:0%}
  to{background-position:200%}
}

/* PETALS */
.petal{
  position:fixed;
  top:-40px;
  font-size:26px;
  animation:fall linear forwards;
}
@keyframes fall{
  to{transform:translateY(110vh) rotate(360deg)}
}
</style>
</head>

<body>

<div class="sunrise"></div>

<!-- AUDIO -->
<audio id="bgMusic" loop muted>
<source src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_5b7a68a4ad.mp3">
</audio>

<audio id="planeSound">
<source src="https://cdn.pixabay.com/download/audio/2021/08/04/audio_plane.mp3">
</audio>

<!-- INTRO -->
<div class="screen active" id="s1">
<div class="card">
<h2>Welcome ğŸŒ»</h2>
<button onclick="start()">Begin</button>
</div>
</div>

<!-- COUNTRY -->
<div class="screen" id="s2">
<div class="card">
<h3>Choose a country ğŸŒ</h3>
<div class="country" onclick="travel('india')">ğŸ‡®ğŸ‡³ India</div>
<div class="country" onclick="travel('saudi')">ğŸ‡¸ğŸ‡¦ Saudi Arabia</div>
<div class="country" onclick="travel('japan')">ğŸ‡¯ğŸ‡µ Japan</div>
<div class="country" onclick="travel('korea')">ğŸ‡°ğŸ‡· South Korea</div>
</div>
</div>

<!-- PLANE -->
<div class="screen" id="s3">
<div class="plane">âœˆï¸</div>
</div>

<!-- CANDLE -->
<div class="screen" id="s4">
<div class="card">
<div class="candle">
<div class="flame" id="flame"></div>
</div>
<p>Blow gently ğŸŒ¬ï¸</p>
<button onclick="enableMic()">Blow ğŸ¤</button>
</div>
</div>

<!-- FINAL -->
<div class="screen" id="s5">
<div class="card">
<h2>ğŸ‰ Happy Birthday ğŸ‰</h2>
<p id="note"></p>
<button onclick="go(2)">Back</button>
</div>
</div>

<script>
let selectedNote="";
let petalInterval;
const music=document.getElementById("bgMusic");
const planeSound=document.getElementById("planeSound");

function start(){
music.muted=false;
music.play();
go(2);
}

function go(n){
document.querySelectorAll(".screen").forEach(s=>s.classList.remove("active"));
document.getElementById("s"+n).classList.add("active");
}

const notes={
india:`<div class="glow">Nimra ğŸ’•</div><br>Janmadin Mubarak ğŸŒ»`,
saudi:`<div class="glow">Nimra ğŸ’•</div><br>Ø¹ÙŠØ¯ Ù…ÙŠÙ„Ø§Ø¯ Ø³Ø¹ÙŠØ¯ ğŸŒ»`,
japan:`<div class="glow">Nimra ğŸ’•</div><br>ãŠèª•ç”Ÿæ—¥ãŠã‚ã§ã¨ã† ğŸŒ»`,
korea:`<div class="glow">Nimra ğŸ’•</div><br>ìƒì¼ ì¶•í•˜í•´ìš” ğŸŒ»`
};

function travel(c){
selectedNote=notes[c];
go(3);
planeSound.play();
setTimeout(()=>{
cloud();
go(4);
},3000);
}

function cloud(){
let puff=document.createElement("div");
puff.className="cloudPuff";
puff.innerHTML="â˜ï¸";
document.body.appendChild(puff);
setTimeout(()=>puff.remove(),1200);
}

/* BLOW DETECTION + FLAME REACTION */
let audioContext, analyser, dataArray, blowing=false;

async function enableMic(){
try{
const stream=await navigator.mediaDevices.getUserMedia({audio:true});
audioContext=new (window.AudioContext||window.webkitAudioContext)();
analyser=audioContext.createAnalyser();
const mic=audioContext.createMediaStreamSource(stream);
mic.connect(analyser);
analyser.fftSize=256;
dataArray=new Uint8Array(analyser.frequencyBinCount);
detectBlow();
}catch{
extinguish();
}
}

function detectBlow(){
if(blowing) return;
analyser.getByteFrequencyData(dataArray);
let volume=dataArray.reduce((a,b)=>a+b)/dataArray.length;

/* flame reacts before blowing */
let flame=document.getElementById("flame");
flame.style.transform=`scale(${1+volume/200})`;

if(volume>50){
blowing=true;
extinguish();
}
requestAnimationFrame(detectBlow);
}

function extinguish(){
document.getElementById("flame").classList.add("hidden");
confetti({particleCount:200,spread:120});
document.getElementById("note").innerHTML=selectedNote;
go(5);
startPetals();
}

function startPetals(){
petalInterval=setInterval(()=>{
let p=document.createElement("div");
p.className="petal";
p.innerHTML="ğŸŒ»";
p.style.left=Math.random()*100+"vw";
p.style.animationDuration=6+Math.random()*4+"s";
document.body.appendChild(p);
setTimeout(()=>p.remove(),10000);
},450);
}
</script>

</body>
</html>
